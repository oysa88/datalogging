{"entries":[{"timestamp":1768944248357,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":234,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":28,"length1":66,"diffs":[[1,"    \"description\": \"\",\n"]]},{"start1":94,"length1":24,"diffs":[[1,"        \"radio\": \"*\",\n        \"microphone\": \"*\"\n"]]},{"start1":164,"length1":24,"diffs":[[1,"        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n"]]},{"start1":233,"length1":494,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"test.ts","value":"// testene settes inn her; disse vil ikke kompilert så lenge denne pakken blir brukt som en utvidelse.\n"},{"type":"added","filename":"datalogger.ts","value":"/**\n * Log data to flash storage\n */\n//% block=\"Data Logger\"\n//% icon=\"\\uf0ce\"\n//% color=\"#378273\"\nnamespace datalogger {\n    export enum DeleteType {\n        //% block=\"fast\"\n        Fast,\n        //% block=\"full\"\n        Full\n    }\n\n    let onLogFullHandler: () => void;\n    let _disabled = false;\n\n    let initialized = false;\n    function init() {\n        if (initialized)\n            return;\n        initialized = true;\n\n        includeTimestamp(FlashLogTimeStampFormat.Seconds);\n        mirrorToSerial(false);\n\n        control.onEvent(DAL.MICROBIT_ID_LOG, DAL.MICROBIT_LOG_EVT_LOG_FULL, () => {\n            _disabled = true;\n            if (onLogFullHandler) {\n                onLogFullHandler();\n            } else {\n                basic.showLeds(`\n                    # . . . #\n                    # # . # #\n                    . . . . .\n                    . # # # .\n                    # . . . #\n                `);\n                basic.pause(1000);\n                basic.clearScreen();\n                basic.showString(\"928\");\n            }\n        });\n    }\n\n\n    export class ColumnValue {\n        public value: string;\n        constructor(\n            public column: string,\n            value: any\n        ) {\n            this.value = \"\" + value;\n        }\n    }\n\n    /**\n     * A column and value to log to flash storage\n     * @param column the column to set\n     * @param value the value to set.\n     * @returns A new value that can be stored in flash storage using log data\n     */\n    //% block=\"kolonne $column verdi $value\"\n    //% value.shadow=math_number\n    //% column.shadow=datalogger_columnfield\n    //% blockId=dataloggercreatecolumnvalue\n    //% group=\"micro:bit (V2)\"\n    //% weight=80 help=datalogger/create-cv\n    export function createCV(column: string, value: any): ColumnValue {\n        return new ColumnValue(column, value);\n    }\n\n    //% block=\"$column\"\n    //% blockId=datalogger_columnfield\n    //% group=\"micro:bit (V2)\"\n    //% blockHidden=true shim=TD_ID\n    //% column.fieldEditor=\"autocomplete\" column.fieldOptions.decompileLiterals=true\n    //% column.fieldOptions.key=\"dataloggercolumn\"\n    export function _columnField(column: string) {\n        return column\n    }\n\n    /**\n     * Log data to flash storage\n     * @param data Array of data to be logged to flash storage\n     */\n    //% block=\"logg data array $data\"\n    //% blockId=dataloggerlogdata\n    //% data.shadow=lists_create_with\n    //% data.defl=dataloggercreatecolumnvalue\n    //% group=\"micro:bit (V2)\"\n    //% blockHidden=true\n    //% weight=100\n    export function logData(data: ColumnValue[]): void {\n        if (!data || !data.length)\n            return;\n        init();\n\n        if (_disabled)\n            return;\n\n        flashlog.beginRow();\n        for (const cv of data) {\n            flashlog.logData(cv.column, cv.value);\n        }\n        flashlog.endRow();\n    }\n\n    /**\n     * Log data to flash storage\n     * @param data1 First column and value to be logged\n     * @param data2 [optional] second column and value to be logged\n     * @param data3 [optional] third column and value to be logged\n     * @param data4 [optional] fourth column and value to be logged\n     * @param data5 [optional] fifth column and value to be logged\n     * @param data6 [optional] sixth column and value to be logged\n     * @param data7 [optional] seventh column and value to be logged\n     * @param data8 [optional] eighth column and value to be logged\n     * @param data9 [optional] ninth column and value to be logged\n     * @param data10 [optional] tenth column and value to be logged\n     */\n    //% block=\"logg data $data1||$data2 $data3 $data4 $data5 $data6 $data7 $data8 $data9 $data10\"\n    //% blockId=dataloggerlog\n    //% data1.shadow=dataloggercreatecolumnvalue\n    //% data2.shadow=dataloggercreatecolumnvalue\n    //% data3.shadow=dataloggercreatecolumnvalue\n    //% data4.shadow=dataloggercreatecolumnvalue\n    //% data5.shadow=dataloggercreatecolumnvalue\n    //% data6.shadow=dataloggercreatecolumnvalue\n    //% data7.shadow=dataloggercreatecolumnvalue\n    //% data8.shadow=dataloggercreatecolumnvalue\n    //% data9.shadow=dataloggercreatecolumnvalue\n    //% data10.shadow=dataloggercreatecolumnvalue\n    //% inlineInputMode=\"variable\"\n    //% inlineInputModeLimit=1\n    //% group=\"micro:bit (V2)\"\n    //% weight=100 help=datalogger/log\n    export function log(\n        data1: datalogger.ColumnValue,\n        data2?: datalogger.ColumnValue,\n        data3?: datalogger.ColumnValue,\n        data4?: datalogger.ColumnValue,\n        data5?: datalogger.ColumnValue,\n        data6?: datalogger.ColumnValue,\n        data7?: datalogger.ColumnValue,\n        data8?: datalogger.ColumnValue,\n        data9?: datalogger.ColumnValue,\n        data10?: datalogger.ColumnValue\n    ): void {\n        logData(\n            [\n                data1,\n                data2,\n                data3,\n                data4,\n                data5,\n                data6,\n                data7,\n                data8,\n                data9,\n                data10,\n            ].filter(el => !!el)\n        );\n    }\n\n    /**\n     * Set the columns for future data logging\n     * @param cols Array of the columns that will be logged.\n     */\n    //% block=\"sett kolonner $cols\"\n    //% blockId=dataloggersetcolumns\n    //% data.shadow=list_create_with\n    //% data.defl=datalogger_columnfield\n    //% group=\"micro:bit (V2)\"\n    //% blockHidden=true\n    //% weight=70\n    export function setColumns(cols: string[]): void {\n        if (!cols)\n            return;\n\n        logData(cols.map(col => createCV(col, \"\")));\n    }\n\n    /**\n     * Set the columns for future data logging\n     * @param col1 Title for first column to be added\n     * @param col2 Title for second column to be added\n     * @param col3 Title for third column to be added\n     * @param col4 Title for fourth column to be added\n     * @param col5 Title for fifth column to be added\n     * @param col6 Title for sixth column to be added\n     * @param col7 Title for seventh column to be added\n     * @param col8 Title for eighth column to be added\n     * @param col9 Title for ninth column to be added\n     * @param col10 Title for tenth column to be added\n     */\n    //% block=\"sett kolonner $col1||$col2 $col3 $col4 $col5 $col6 $col7 $col8 $col9 $col10\"\n    //% blockId=dataloggersetcolumntitles\n    //% inlineInputMode=\"variable\"\n    //% inlineInputModeLimit=1\n    //% group=\"micro:bit (V2)\"\n    //% weight=70 help=datalogger/set-column-titles\n    //% col1.shadow=datalogger_columnfield\n    //% col2.shadow=datalogger_columnfield\n    //% col3.shadow=datalogger_columnfield\n    //% col4.shadow=datalogger_columnfield\n    //% col5.shadow=datalogger_columnfield\n    //% col6.shadow=datalogger_columnfield\n    //% col7.shadow=datalogger_columnfield\n    //% col8.shadow=datalogger_columnfield\n    //% col9.shadow=datalogger_columnfield\n    //% col10.shadow=datalogger_columnfield\n    export function setColumnTitles(\n        col1: string,\n        col2?: string,\n        col3?: string,\n        col4?: string,\n        col5?: string,\n        col6?: string,\n        col7?: string,\n        col8?: string,\n        col9?: string,\n        col10?: string\n    ): void {\n        logData(\n            [col1, col2, col3, col4, col5, col6, col7, col8, col9, col10]\n                .filter(el => !!el)\n                .map(col => createCV(col, \"\"))\n        );\n    }\n\n    /**\n     * Delete all existing logs, including column headers. By default this only marks the log as\n     * overwriteable / deletable in the future.\n     * @param deleteType optional set whether a deletion will be fast or full\n     */\n    //% block=\"slett logg||$deleteType\"\n    //% blockId=dataloggerdeletelog\n    //% group=\"micro:bit (V2)\"\n    //% weight=60 help=datalogger/delete-log\n    export function deleteLog(deleteType?: DeleteType): void {\n        init();\n        flashlog.clear(deleteType === DeleteType.Full);\n        _disabled = false;\n    }\n\n    /**\n     * Register an event to run when no more data can be logged.\n     * @param handler code to run when the log is full and no more data can be stored.\n     */\n    //% block=\"når logg er full\"\n    //% blockId=\"on log full\"\n    //% group=\"micro:bit (V2)\"\n    //% weight=40 help=datalogger/on-log-full\n    export function onLogFull(handler: () => void): void {\n        init();\n        onLogFullHandler = handler;\n    }\n\n    /**\n     * Set the format for timestamps\n     * @param format Format in which to show the timestamp. Setting FlashLogTimeStampFormat.None will disable the timestamp.\n     */\n    //% block=\"sett tidsstempel $format\"\n    //% blockId=dataloggertoggleincludetimestamp\n    //% format.defl=FlashLogTimeStampFormat.None\n    //% group=\"micro:bit (V2)\"\n    //% weight=30 help=datalogger/include-timestamp\n    export function includeTimestamp(format: FlashLogTimeStampFormat): void {\n        init();\n        flashlog.setTimeStamp(format);\n    }\n\n    /**\n     * Set whether data is mirrored to serial or not.\n     * @param on if true, data that is logged will be mirrored to serial\n     */\n    //% block=\"speil data til serial $on\"\n    //% blockId=dataloggertogglemirrortoserial\n    //% on.shadow=toggleOnOff\n    //% on.defl=false\n    //% weight=25 help=datalogger/mirror-to-serial\n    export function mirrorToSerial(on: boolean): void {\n        // TODO:/note intentionally does not have group, as having the same group for all\n        // blocks in a category causes the group to be elided.\n        init();\n        flashlog.setSerialMirroring(on);\n    }\n\n    /**\n     * Number of rows currently used by the datalogger, start counting at fromRowIndex\n     * Treats the header as the first row\n     * @param fromRowIndex 0-based index of start\n     * @returns header + rows\n     */\n    export function getNumberOfRows(fromRowIndex: number = 0): number {\n        return flashlog.getNumberOfRows(fromRowIndex);\n    }\n\n    /**\n     * Get all rows seperated by a newline & each column seperated by a comma.\n     * Starting at the 0-based index fromRowIndex & counting inclusively until nRows.\n     * @param fromRowIndex 0-based index of start\n     * @param nRows inclusive count from fromRowIndex\n     * @returns String where newlines denote rows & commas denote columns\n     */\n    export function getRows(fromRowIndex: number, nRows: number): string {\n        return flashlog.getRows(fromRowIndex, nRows);\n    }\n}\n"}]}],"snapshots":[{"timestamp":1768944248356,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"datalogger\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1768944792364}